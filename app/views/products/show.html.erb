<div class="container-fluid animated fadeIn">
  <div class="row">
    <div class="col-xs-12 col-md-10 col-md-offset-1">
      <%= image_tag(@product.image_url, class: "img-responsive show-view-image", data_zoom_image: @product.image_url) %>
    </div>
  </div>
  <div class="row mb3" data-product-id="<%= @product.id %>">
    <div class="col-xs-10 col-xs-offset-1">
      <h2 class="sub-header product-header">
        <%= @product.name %>
        <span class="price">
          (<i class="fa fa-dollar-sign"></i><%= @product.price/100 %>)
        </span>
      </h2>

      <div class="product-header-underline">
      </div>

      <% cache @product do %>
      <div class="row sub-row">
        <div class="col-xs-12 col-md-4 more-images-container">
          <h3 class="mb1">More Images</h3>
          <div class="more-images-gallery">
            <div class="row no-margin">
              <div class="col-md-6 image-box">
                <%= image_tag("flo-karr-144400-unsplash.jpg", class: "img-responsive") %>
              </div>
              <div class="col-md-6 image-box">
                <%= image_tag("flo-karr-144400-unsplash.jpg", class: "img-responsive") %>
              </div>
            </div>
            <div class="row no-margin">
              <div class="col-md-6 image-box">
                <%= image_tag("flo-karr-144400-unsplash.jpg", class: "img-responsive") %>
              </div>
              <div class="col-md-6 image-box">
                <%= image_tag("flo-karr-144400-unsplash.jpg", class: "img-responsive") %>
              </div>
            </div>
          </div>
        </div>

        <div class="col-xs-12 col-md-5">
          <h3 class="mb1">Description</h3>
          <p class="justify">
            <%= @product.description %>
          </p>
        </div>

        <div class="col-xs-12 col-md-3">
          <h3 class="mb1">Product Details</h3>
          <div class="product-details-container">
            <p>
              Colour: <%= @product.colour %>
            </p>
            <p>
              Price: <%= @product.price/100 %>
            </p>

            <p>Average Rating:
              <div class="rated" id="average-rating" data-score="<%= @product.average_rating %>">
              </div>
            </p>
          </div>
        </div>

        <div class="row">
          <div class="col-md-4 col-md-offset-4">
            <p>
              <%= form_with(url: '/payments/create') do |form| %>
                <%= render partial: "shared/stripe_checkout_button" %>
                <%= hidden_field_tag(:product_id, @product.id) %>
              <% end %>
            </p>
          </div>
        </div>
      </div> <!-- end sub-row -->

      <div class="row sub-row product-reviews">
        <div class="col-xs-12">
          <h3>User Feedback</h3>
          <p>
            <%= @product.highest_rating_comment&.rating %>
            <%= @product.lowest_rating_comment&.rating %>

          </p>
          <div class="alert alert-info" style="display:none" role="alert">A new comment was posted!</div>
          <%= render 'comments' %>
        </div>
      </div>

      <% end %> <!-- end cache loop -->


      <% if signed_in? %>
        <div class="row sub-row review-container">
          <%= render 'new_comment' %>
        </div>
      <% end %>

    </div>
  </div>
</div>

<% if signed_in? && current_user.admin? %>
  <%= link_to 'Edit', edit_product_path(@product) %>
<% end %>
